import{d as le,r as E,w as q,o as d,c as g,a as f,b as R,e as W,v as H,F as b,f as P,g as oe,h as re,i as j,n as V,u as ie,_ as se,j as ue,k as J,l as ae}from"./app.5c253a19.js";import{c as ce,a as X}from"./chunks/board.9fbf0e45.js";const e={Up:1,Right:2,Down:4,Left:8};function v(...n){const t=n.reduce((l,i)=>l|i,0);return t}function T(n,t){return(n&t)!==0}function $(n,t){return n&~t}const o={Empty:0,TopLeft:1,LeftBottom:2,BottomRight:3,RightTop:4,TopBottom:5,LeftRight:6,All:7,Wall:8},fe={[o.Empty]:v(),[o.TopLeft]:v(e.Up,e.Left),[o.LeftBottom]:v(e.Down,e.Left),[o.BottomRight]:v(e.Down,e.Right),[o.RightTop]:v(e.Up,e.Right),[o.TopBottom]:v(e.Up,e.Down),[o.LeftRight]:v(e.Left,e.Right),[o.All]:v(e.Up,e.Left,e.Down,e.Right),[o.Wall]:v()};function G(n){return ce(o,{width:n.width,height:n.height,outline:o.Empty,inside:o.Empty})}function F(n){switch(n){case o.TopLeft:return[e.Up,e.Left];case o.LeftBottom:return[e.Down,e.Left];case o.BottomRight:return[e.Down,e.Right];case o.RightTop:return[e.Up,e.Right];case o.TopBottom:return[e.Up,e.Down];case o.LeftRight:return[e.Left,e.Right];case o.All:return[e.Up,e.Left,e.Down,e.Right];case o.Empty:return[];case o.Wall:return[];default:throw new Error("Unknown cell "+n)}}function pe(n,t){return n===t?o.Empty:[o.TopLeft,o.LeftBottom,o.BottomRight,o.RightTop,o.TopBottom,o.LeftRight].find(i=>{const s=F(i);return s.includes(n)&&s.includes(t)})??o.Empty}function he(n){return fe[n]}function k(n){switch(n){case e.Up:return e.Down;case e.Right:return e.Left;case e.Down:return e.Up;case e.Left:return e.Right;default:throw new Error("Unknown direction "+n)}}function N(n,t,l){return t<0||t>=n.width||l<0||l>=n.height?null:n.cells[l][t]}function de(n,t,l){return ge([[e.Up,N(n,t,l-1)??o.Wall],[e.Right,N(n,t+1,l)??o.Wall],[e.Down,N(n,t,l+1)??o.Wall],[e.Left,N(n,t-1,l)??o.Wall]])}function ge(n){return new Map(n)}const I={MustHave:0,MustNotHave:1,Optional:2};function Y(n,t){const l=F(n);return[e.Up,e.Right,e.Down,e.Left].every(s=>{if(t.get(s)===I.Optional)return!0;{const c=l.includes(s);return t.get(s)===I.MustHave===c}})}function me(n,t){const l=new Map;for(const[i,s]of n)l.set(i,t(i,s));return l}function Z(n,t,l){return me(de(n,t,l),(i,s)=>s===o.Empty?I.Optional:F(s).includes(k(i))?I.MustHave:I.MustNotHave)}function ee(n,t,l){if(n.cells[l][t]===o.Empty){const s=Z(n,t,l);return[o.TopLeft,o.LeftBottom,o.BottomRight,o.RightTop,o.TopBottom,o.LeftRight,o.All].filter(w=>Y(w,s))}else return[]}function we(n){const t={score:1/0,x:0,y:0,possibleCells:[]};for(let l=0;l<n.height;l++)for(let i=0;i<n.width;i++)if(n.cells[l][i]===o.Empty){const s=ee(n,i,l);if(s.length==0)return{x:i,y:l,possibleCells:[]};if(s.length==1)return{x:i,y:l,possibleCells:s};s.length<t.score&&(t.score=s.length,t.x=i,t.y=l,t.possibleCells=s)}return t}function*te(n){if(!ye(n))return;const t=[n];if(K(n)){yield n;return}for(;;){const l=t.pop();if(l===void 0)return;const i=we(l);if(i.possibleCells.length!==0)for(const s of i.possibleCells){const c=X(l);c.cells[i.y][i.x]=s,ve(c)>=1?K(c)&&(yield c):t.push(c)}}}function K(n){return n.cells.every(t=>t.every(l=>l!==o.Empty))}function ye(n){for(let t=0;t<n.height;t++)for(let l=0;l<n.width;l++){if(n.cells[t][l]===o.Empty)continue;const i=Z(n,l,t);if(!Y(n.cells[t][l],i))return!1}return!0}function ve(n){const t=n.cells.map(s=>s.map(c=>he(c))),l=v();let i=0;return t.forEach((s,c)=>s.forEach((w,_)=>{if(w===l)return;Ce(n,t,_,c)&&(i+=1)})),i}function Ce(n,t,l,i){const s=t[i][l],c=T(s,e.Up)?e.Up:T(s,e.Right)?e.Right:T(s,e.Down)?e.Down:T(s,e.Left)?e.Left:null;if(c===null)throw new Error("Invalid starting cell");const w=Q(n.cells[i][l],c);if(w===null)throw new Error("Invalid starting cell, missing exit");const _=[[l,i,w,c]];for(;;){const B=_.pop();if(B===void 0)return!1;const[m,U,M,C]=B;t[U][m]=$($(t[U][m],C),M);const[D,L]=Le(m,U,C);if(D===l&&L===i)return!0;const S=t[L][D];if(T(S,k(C))){const A=n.cells[L][D],z=Q(A,k(C));if(z===null)throw new Error("Invalid exit direction, this shouldn't happen if the board is valid "+A+" "+C);_.push([D,L,k(C),z])}else return!1}}function Le(n,t,l){switch(l){case e.Up:return[n,t-1];case e.Left:return[n-1,t];case e.Down:return[n,t+1];case e.Right:return[n+1,t];default:throw new Error("Invalid direction")}}function Q(n,t){switch(n){case o.Empty:return null;case o.TopLeft:return t===e.Up?e.Left:t===e.Left?e.Up:null;case o.LeftBottom:return t===e.Left?e.Down:t===e.Down?e.Left:null;case o.BottomRight:return t===e.Down?e.Right:t===e.Right?e.Down:null;case o.RightTop:return t===e.Right?e.Up:t===e.Up?e.Right:null;case o.TopBottom:return t===e.Up?e.Down:t===e.Down?e.Up:null;case o.LeftRight:return t===e.Left?e.Right:t===e.Right?e.Left:null;case o.All:return k(t);case o.Wall:return null;default:throw new Error("Invalid cell")}}function Re(n){const t=[];for(let l=0;l<n.height;l++)for(let i=0;i<n.width;i++)n.cells[l][i]===o.Empty&&ee(n,i,l).map(s=>({x:i,y:l,cell:s})).forEach(s=>t.push(s));for(;;){const l=Math.floor(Math.random()*t.length),i=t[l],s=X(n);s.cells[i.y][i.x]=i.cell;let c=0;for(const w of te(s))if(c+=1,c>=2)break;if(c===0)t.splice(l,1);else return c==1,s}}const _e=["data-cell-x","data-cell-y"],xe={key:0,class:"solutions-container"},De=le({__name:"Pipelink",setup(n){const t=E({width:10,height:10}),l=E(G(t.value)),i=E(new URL(window.location.href).searchParams.get("showSolutions")!=="false");q(t,r=>{l.value=G(r)},{deep:!0,flush:"sync"}),(()=>{const a=new URL(window.location.href).searchParams.get("board");if(a)try{const u=JSON.parse(a);t.value={width:u.width,height:u.height},l.value=u}catch(u){console.error(u)}})();const s=E([]);q(l,async r=>{s.value=await w(ie(r),4)},{deep:!0});const c=r=>new Promise(a=>setTimeout(a,r));async function w(r,a){await c(0);const u=[];for(const h of te(r)){if(u.push(h),u.length>=a)break;await c(0)}return u}function _(r){return r===o.Empty?"cell-empty":r===o.TopLeft?"cell-top-left":r===o.LeftBottom?"cell-left-bottom":r===o.BottomRight?"cell-bottom-right":r===o.RightTop?"cell-right-top":r===o.TopBottom?"cell-top-bottom":r===o.LeftRight?"cell-left-right":r===o.All?"cell-all":r===o.Wall?"cell-wall":""}function B(){const r=new URL(window.location.href);r.searchParams.set("board",JSON.stringify(l.value)),navigator.clipboard.writeText(r+"").then(()=>{console.log("copied")},()=>{console.log("copying failed")})}const m=E(null);function U(r){if(r===e.Up)return"drawing-up";if(r===e.Down)return"drawing-down";if(r===e.Left)return"drawing-left";if(r===e.Right)return"drawing-right"}function M(r,a){const u=a.getBoundingClientRect(),h=(r.clientX-u.left)/u.width,p=(r.clientY-u.top)/u.height;return{x:h,y:p}}function C(r){const a=r.x-.5-(r.y-.5)>0,u=r.x-.5+(r.y-.5)>0;return a&&!u?e.Up:a&&u?e.Right:!a&&u?e.Down:e.Left}function D(r,a){let u=r;for(;u;){if(u.classList.contains(a))return u;u=u.parentElement}return null}function L(r){const a=D(document.elementFromPoint(r.clientX,r.clientY),"cell");if(!a)return;const u=M(r,a),h=C(u),p={x:+(a.getAttribute("data-cell-x")??0),y:+(a.getAttribute("data-cell-y")??0)};return{direction:h,coords:p}}function S(r){if(r.currentTarget.setPointerCapture(r.pointerId),r.buttons===2){const p=L(r);if(!p)return;const{coords:x}=p;l.value.cells[x.y][x.x]=o.Empty}if(r.buttons!==1)return;const a=L(r);if(!a)return;const{direction:u,coords:h}=a;m.value={x:h.x,y:h.y,direction:u,originalCell:l.value.cells[h.y][h.x]}}function A(r){if(r.buttons!==1)return;const a=m.value;if(!a)return;const u=L(r);if(!u)return;const{direction:h,coords:p}=u;if(p.x!==a.x||p.y!==a.y)m.value={x:p.x,y:p.y,direction:h,originalCell:l.value.cells[p.y][p.x]};else{let y=pe(a.direction,h);(a.originalCell==o.TopBottom&&y==o.LeftRight||a.originalCell==o.LeftRight&&y==o.TopBottom)&&(y=o.All),l.value.cells[p.y][p.x]=y}}function z(r){m.value=null,r.currentTarget.releasePointerCapture(r.pointerId)}function ne(){l.value=Re(l.value)}return(r,a)=>(d(),g(b,null,[f("div",null,[R(" Playing field size "),W(f("input",{type:"number",min:"3",max:"999",size:3,"onUpdate:modelValue":a[0]||(a[0]=u=>t.value.width=u)},null,512),[[H,t.value.width]]),R(" x "),W(f("input",{type:"number",min:"3",max:"999",size:3,"onUpdate:modelValue":a[1]||(a[1]=u=>t.value.height=u)},null,512),[[H,t.value.height]])]),f("table",{tabIndex:0,className:"game-table",onPointerdown:S,onPointermove:A,onPointerup:z,onContextmenu:a[2]||(a[2]=oe(()=>{},["prevent"]))},[f("tbody",null,[(d(!0),g(b,null,P(l.value.cells,(u,h)=>(d(),g("tr",null,[(d(!0),g(b,null,P(u,(p,x)=>{var y,O;return d(),g("td",{class:"cell","data-cell-x":x,"data-cell-y":h},[f("div",{class:V(["game-table-cell",_(p)])},null,2),((y=m.value)==null?void 0:y.x)===x&&((O=m.value)==null?void 0:O.y)===h?(d(),g("div",{key:0,class:V(["game-table-cell-drawing",U(m.value.direction)])},null,2)):j("",!0)],8,_e)}),256))]))),256))])],32),f("div",null,[f("button",{onClick:B},"Copy")]),f("h2",null,[R("Solutions "),W(f("input",{type:"checkbox","onUpdate:modelValue":a[3]||(a[3]=u=>i.value=u)},null,512),[[re,i.value]])]),i.value?(d(),g("div",xe,[f("div",null,[f("button",{onClick:ne},"Add random tile from solution")]),(d(!0),g(b,null,P(s.value,(u,h)=>(d(),g("table",{key:h,tabIndex:0,className:"game-table"},[f("tbody",null,[(d(!0),g(b,null,P(u.cells,(p,x)=>(d(),g("tr",null,[(d(!0),g(b,null,P(p,(y,O)=>(d(),g("td",null,[f("div",{class:V(["game-table-cell",_(y)])},null,2)]))),256))]))),256))])]))),128))])):j("",!0)],64))}});const be=se(De,[["__scopeId","data-v-680a0479"]]),Be=f("h1",{id:"pipelink",tabindex:"-1"},[R("Pipelink! "),f("a",{class:"header-anchor",href:"#pipelink","aria-hidden":"true"},"#")],-1),Ue=f("p",null,[R("I remember seeing this game in an Arabian newspaper, and playing it every time. I quite enjoyed it back then, "),f("em",null,"but I couldn't remember the name"),R(".")],-1),Ee=f("p",null,"<cue glorified tales of countless struggles while I was trying to hunt it down>",-1),Pe=f("p",null,[R("Finding an obscure puzzle without having a name is hard to say the least. So I was overjoyed when a lovely user by the name of qqwref from the "),f("a",{href:"https://www.puzzle-loop.com/",target:"_blank",rel:"noreferrer"},"Puzzle Loop"),R(" Discord server managed to hunt it down!")],-1),Te=f("p",null,"So happy that I wrote a solver for it.",-1),ze=JSON.parse('{"title":"Pipelink!","description":"","frontmatter":{},"headers":[],"relativePath":"Puzzles/pipelink.md"}'),ke={name:"Puzzles/pipelink.md"},Ne=Object.assign(ke,{setup(n){return(t,l)=>{const i=ue("ClientOnly");return d(),g("div",null,[Be,Ue,Ee,Pe,Te,J(i,null,{default:ae(()=>[J(be)]),_:1})])}}});export{ze as __pageData,Ne as default};
